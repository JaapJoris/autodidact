{% extends 'base.html' %}
{% load static %}
{% load markdown_tag %}

{% block navigation %}
<li class="visitedPage"><a href="{% url 'homepage' %}">Home</a></li>
<li class="visitedPage"><a href="{% url 'course' course.slug %}">{{course.name}}<br>(<code>{{course.colloquial_name}}</code>)</a></li>
<li class="visitedPage"><a href="{% url 'session' course.slug session_nr %}">Session {{session_nr}}</a></li>
<li class="currentPage"><a href="{% url 'assignment' course.slug session_nr assignment_nr %}">Assignment {{assignment_nr}}</a></li>
{% endblock %}

{% block editor %}
{% if perms.autodidact.change_assignment %}
<a class="editlink" href="{% url 'admin:autodidact_assignment_change' assignment.pk %}">Edit this assignment</a>
{% if step and perms.autodidact.change_step %}
- <a class="editlink" href="{% url 'admin:autodidact_step_change' step.pk %}">Edit this step</a>
{% endif %}
{% endif %}
{% endblock %}

{% block content %}
{% if step %}

<section class="step">
  <form method="POST" action="{% url 'assignment' course.slug session_nr assignment_nr %}?step={{step_nr}}">
	{% csrf_token %}
	<table>
	  <tr>
		<td class="header">
		  <img id="checkbox" src="{% if completed %}{% static 'checked.png' %}{% else %}{% static 'unchecked.png' %}{% endif %}" alt="Completed" width="24" height="24" />
		  <h1>Step {{step_nr}} of {{count}}: {{step.name}}</h1>
		</td>
	  </tr>
	  <tr>
		<td class="content">
		  {{step.description|markdown}}
		</td>
	  </tr>
	  {% if step.answer_required %}
	  <tr>
		<td class="answer">
		  Your answer:
		  <textarea id="answerbox" name="answer">{{completed.answer}}</textarea>
		</td>
	  </tr>
	  {% endif %}
	  <tr>
		<td class="footer">
		  {% if save_only %}
		  <input class="right button" type="submit" name="direction" value="Save" />
		  {% else %}
		  {% if not first %}
		  <input class="left button" type="submit" name="direction" value="Previous" />
		  {% endif %}
		  {% if not last %}
		  <input class="right button" type="submit" name="direction" value="Next" />
		  {% else %}
		  <input class="right button finish" type="submit" name="direction" value="Finish!" />
		  {% endif %}
		  {% endif %}
		</td>
	  </tr>
	</table>
  </form>
</section>

{% else %}
<section>
  This step does not exist. <a href="{% url 'assignment' course.slug session_nr assignment_nr %}">Go back to step 1</a>.
</section>
{% endif %}
{% endblock %}
